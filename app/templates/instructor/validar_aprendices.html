{% extends "base.html" %}

{% block extra_css %}
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/instructor/panel.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/instructor/modal.css') }}">
{% endblock %}

{% block content %}
<div class="instructor-panel">
  <h2><i class="fas fa-user-check"></i> Validar Aprendices</h2>
  <div class="table-container">
    <table class="instructor-table">
      <thead>
        <tr>
          <th><i class="fas fa-user"></i> Nombre</th>
          <th><i class="fas fa-id-card"></i> Documento</th>
          <th><i class="fas fa-envelope"></i> Email</th>
          <th><i class="fas fa-file-alt"></i> Ficha</th>
          <th><i class="fas fa-calendar-alt"></i> Fecha de Registro</th>
          <th><i class="fas fa-cogs"></i> Acciones</th>
        </tr>
      </thead>
      <tbody>
        {% for aprendiz in aprendices %}
        <tr>
          <td>{{ aprendiz.nombre }}</td>
          <td>{{ aprendiz.documento }}</td>
          <td>{{ aprendiz.email }}</td>
          <td>{{ aprendiz.ficha.nombre }}</td>
          <td>{{ aprendiz.fecha_registro.strftime('%d/%m/%Y %H:%M') }}</td>
          <td>
            <form action="{{ url_for('main.validar_aprendiz', id_usuario=aprendiz.id_usuario, accion='aprobar') }}" method="POST" style="display:inline-block;">
              <button type="submit" class="btn btn-primary" onclick="return confirm('¿Está seguro de aprobar a este aprendiz?')"><i class="fas fa-check"></i> Aprobar</button>
            </form>
            <form action="{{ url_for('main.validar_aprendiz', id_usuario=aprendiz.id_usuario, accion='rechazar') }}" method="POST" style="display:inline-block;">
              <button type="submit" class="btn btn-secondary" onclick="return confirm('¿Está seguro de rechazar a este aprendiz? Esta acción no se puede deshacer.')"><i class="fas fa-times"></i> Rechazar</button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    {% if not aprendices or aprendices|length == 0 %}
      <div style="text-align:center; color:#888; margin-top:24px; font-size:1.1rem;">No hay aprendices pendientes de validación en tus fichas.</div>
    {% endif %}
  </div>
</div>

<!-- Modal para mensaje de no fichas asignadas -->
{% with messages = get_flashed_messages() %}
<div id="noFichasModal" class="modal-overlay" data-show="{{ 'true' if 'No tienes fichas asignadas como instructor líder' in messages else 'false' }}">
  <div class="modal-container">
    <div class="modal-header">
      <i class="fas fa-exclamation-circle"></i>
      <h3>Aviso</h3>
    </div>
    <div class="modal-body">
      No tienes fichas asignadas como instructor líder.
    </div>
    <div class="modal-footer">
      <button class="modal-btn" data-url="{{ url_for('main.dashboard') }}">
        <i class="fas fa-home"></i> Volver al Inicio
      </button>
    </div>
  </div>
</div>
{% endwith %}
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/instructor/validar_aprendices.js') }}"></script>
{% endblock %} 