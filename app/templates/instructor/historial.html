{% extends "base.html" %}
{% block extra_css %}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/instructor/instructor.css') }}">
{% endblock %}
{% block content %}
<div class="instructor-panel">
  <h2>Historial de Solicitudes</h2>
  <div class="instructor-card" style="max-width:900px;margin:auto;">
    <h3 style="color:#2e7d32;">Historial de Solicitudes</h3>
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="alert alert-{{ category }}">{{ message }}</div>
        {% endfor %}
      {% endif %}
    {% endwith %}
    <div class="table-responsive">
      <table class="instructor-table">
        <thead>
          <tr>
            <th>Aprendiz</th>
            <th>Tipo de Salida</th>
            <th>Hora Salida</th>
            <th>Hora Reingreso</th>
            <th>Estado</th>
            <th>Fecha</th>
          </tr>
        </thead>
        <tbody>
          {% for solicitud in historial %}
          <tr>
            <td>{{ solicitud.aprendiz.nombre }}</td>
            <td>{{ solicitud.tipo_salida.nombre }}</td>
            <td>{{ solicitud.hora_salida_estimada.strftime('%H:%M') }}</td>
            <td>{{ solicitud.hora_reingreso_estimada.strftime('%H:%M') if solicitud.hora_reingreso_estimada else 'N/A' }}</td>
            <td>
              {% if solicitud.estado.value == 'aprobada' %}
                <span class="badge-aprobada">{{ solicitud.estado.value }}</span>
              {% else %}
                <span class="badge-rechazada">{{ solicitud.estado.value }}</span>
              {% endif %}
            </td>
            <td>{{ solicitud.fecha_creacion.strftime('%d/%m/%Y %H:%M') }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      {% if not historial or historial|length == 0 %}
        <div style="text-align:center; color:#888; margin-top:24px; font-size:1.1rem;">No hay historial de solicitudes.</div>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %} 