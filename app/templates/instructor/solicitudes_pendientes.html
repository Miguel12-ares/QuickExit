{% extends "base.html" %}
{% block extra_css %}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/instructor/solicitudes_pendientes.css') }}">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
{% endblock %}
{% block content %}
<div class="instructor-panel">
  <h2><i class="fas fa-clipboard-list"></i> Solicitudes Pendientes</h2>
  <div class="instructor-card">
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="alert alert-{{ category }}">{{ message }}</div>
        {% endfor %}
      {% endif %}
    {% endwith %}
    <div class="table-container">
      <table class="instructor-table">
        <thead>
          <tr>
            <th><i class="fas fa-user"></i> Aprendiz</th>
            <th><i class="fas fa-door-open"></i> Tipo de Salida</th>
            <th><i class="fas fa-clock"></i> Hora Salida</th>
            <th><i class="fas fa-clock"></i> Hora Reingreso</th>
            <th><i class="fas fa-align-left"></i> Motivo</th>
            <th><i class="fas fa-cogs"></i> Acciones</th>
          </tr>
        </thead>
        <tbody>
          {% for solicitud in pendientes %}
          <tr>
            <td>{{ solicitud.aprendiz.nombre }}</td>
            <td>{{ solicitud.tipo_salida.nombre }}</td>
            <td>{{ solicitud.hora_salida_estimada.strftime('%H:%M') }}</td>
            <td>{{ solicitud.hora_reingreso_estimada.strftime('%H:%M') if solicitud.hora_reingreso_estimada else 'N/A' }}</td>
            <td>{{ solicitud.motivo }}</td>
            <td class="actions-cell">
              <div class="form-actions">
                <form action="{{ url_for('main.instructor_gestionar_solicitud', id_solicitud=solicitud.id_solicitud, accion='aprobar') }}" method="POST">
                  <button type="submit" class="btn btn-primary"><i class="fas fa-check"></i> Aprobar</button>
                </form>
                <form action="{{ url_for('main.instructor_gestionar_solicitud', id_solicitud=solicitud.id_solicitud, accion='rechazar') }}" method="POST">
                  <button type="submit" class="btn btn-secondary"><i class="fas fa-times"></i> Rechazar</button>
                </form>
              </div>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    
    {% if not pendientes or pendientes|length == 0 %}
      <div class="empty-state">
        <i class="fas fa-inbox"></i>
        <p>No hay solicitudes pendientes.</p>
      </div>
    {% endif %}
  </div>
</div>
{% endblock %} 